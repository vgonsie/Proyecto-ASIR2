<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <title>Herramienta de Pentesting</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='styles.css') }}">
</head>
<body>
    <div class="container">
        <header>
            <h1>Simulación de Ataques</h1>
            <div class="user-info">
                <span>Usuario: {{ username }}</span>
                <a href="{{ url_for('logout') }}" class="logout-btn">Cerrar sesión</a>
            </div>
        </header>

        {% if message %}
        <div class="message-box">{{ message }}</div>
        {% endif %}

        <form method="POST">
            <label for="ip">IP de destino:</label>
            <input type="text" id="ip" name="ip" placeholder="192.168.1.1" required>

            <!-- Tipo de ataque -->
            <div class="form-section">
                <label for="tipo_ataque">Tipo de ataque:</label>
                <select name="tipo_ataque" required>
                    <option value="nmap">Escaneo Nmap (-sV)</option>
                    <option value="hydra">Ataque Hydra</option>
                    <option value="syn_flood">DoS SYN Flood</option>
                </select>
            </div>

            <!-- Campos para Hydra -->
            <div class="form-section" id="hydra-fields" style="display:none;">
                <label for="diccionario">Diccionario:</label>
                <select name="diccionario" required>
                    {% for diccionario in diccionarios %}
                        <option value="{{ diccionario }}">{{ diccionario }}</option>
                    {% endfor %}
                </select>

                <label for="usuario">Usuario:</label>
                <input type="text" name="usuario" value="debian" required>

                <label for="protocolo">Protocolo:</label>
                <select name="protocolo" required>
                    <option value="ssh">SSH</option>
                    <option value="ftp">FTP</option>
                    <option value="http">HTTP</option>
                </select>
            </div>

            <!-- Botones -->
            <div class="buttons">
                <button type="submit" name="submit" class="hydra-btn">Ejecutar Ataque</button>
            </div>
        </form>

        <!-- Scripts para mostrar campos solo si es Hydra -->
        <script>
            const tipoAtaque = document.querySelector("[name=tipo_ataque]");
            const hydraFields = document.getElementById("hydra-fields");

            tipoAtaque.addEventListener("change", () => {
                hydraFields.style.display = (tipoAtaque.value === "hydra") ? "block" : "none";
            });
        </script>
    </div>
</body>
</html>
